<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrigar CRM - Add New Vendor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .sidebar {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .sidebar .nav-link {
            color: rgba(255, 255, 255, 0.8);
            padding: 12px 20px;
            margin: 4px 0;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .sidebar .nav-link:hover {
            color: white;
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }
        .form-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: none;
        }
        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        .section-header {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }
        .machine-checkbox {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #dee2e6;
        }
        .machine-checkbox.checked {
            background: #e7f3ff;
            border-color: #0066cc;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 sidebar p-0">
                <div class="p-3">
                    <h4 class="text-white mb-4">
                        <i class="fas fa-cogs me-2"></i>
                        Carrigar CRM
                    </h4>
                    <nav class="nav flex-column">
                        <a class="nav-link" href="{% url 'crm_dashboard' %}">
                            <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                        </a>
                        <a class="nav-link" href="{% url 'crm_orders' %}">
                            <i class="fas fa-clipboard-list me-2"></i>Orders
                        </a>
                        <a class="nav-link" href="{% url 'crm_vendors' %}">
                            <i class="fas fa-industry me-2"></i>Vendors
                        </a>
                        <a class="nav-link" href="{% url 'crm_analytics' %}">
                            <i class="fas fa-chart-bar me-2"></i>Analytics
                        </a>
                        <hr class="text-white-50">
                        <a class="nav-link" href="{% url 'home' %}">
                            <i class="fas fa-home me-2"></i>Main Site
                        </a>
                        <a class="nav-link" href="/admin/">
                            <i class="fas fa-cog me-2"></i>Django Admin
                        </a>
                        <a class="nav-link" href="/accounts/logout/">
                            <i class="fas fa-sign-out-alt me-2"></i>Logout
                        </a>
                    </nav>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 col-lg-10">
                <!-- Header -->
                <div class="header-section">
                    <div class="container-fluid">
                        <div class="row align-items-center">
                            <div class="col">
                                <h2 class="mb-1">
                                    <i class="fas fa-plus me-2"></i>
                                    Add New Vendor
                                </h2>
                                <p class="mb-0 opacity-75">Create a new manufacturing vendor profile</p>
                            </div>
                            <div class="col-auto">
                                <a href="{% url 'crm_vendors' %}" class="btn btn-light">
                                    <i class="fas fa-arrow-left me-1"></i>Back to Vendors
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container-fluid">
                    <!-- Messages -->
                    {% if messages %}
                        {% for message in messages %}
                            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                        {% endfor %}
                    {% endif %}

                    <form method="post" class="needs-validation" novalidate>
                        {% csrf_token %}
                        
                        <!-- Basic Information -->
                        <div class="card form-card mb-4">
                            <div class="card-body">
                                <div class="section-header">
                                    <h5 class="mb-0">
                                        <i class="fas fa-building me-2"></i>Basic Information
                                    </h5>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="company_name" class="form-label">Company Name *</label>
                                        <input type="text" class="form-control" id="company_name" name="company_name" required>
                                        <div class="invalid-feedback">Please provide a company name.</div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="contact_person" class="form-label">Contact Person *</label>
                                        <input type="text" class="form-control" id="contact_person" name="contact_person" required>
                                        <div class="invalid-feedback">Please provide a contact person.</div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="email" class="form-label">Email *</label>
                                        <input type="email" class="form-control" id="email" name="email" required>
                                        <div class="invalid-feedback">Please provide a valid email.</div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="phone" class="form-label">Phone *</label>
                                        <input type="tel" class="form-control" id="phone" name="phone" required>
                                        <div class="invalid-feedback">Please provide a phone number.</div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="address" class="form-label">Address</label>
                                    <textarea class="form-control" id="address" name="address" rows="2"></textarea>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label for="primary_service" class="form-label">Primary Service *</label>
                                        <select class="form-select" id="primary_service" name="primary_service" required>
                                            <option value="">Select Primary Service</option>
                                            {% for value, display in vendor_service_choices %}
                                                <option value="{{ value }}">{{ display }}</option>
                                            {% endfor %}
                                        </select>
                                        <div class="invalid-feedback">Please select a primary service.</div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label for="status" class="form-label">Status</label>
                                        <select class="form-select" id="status" name="status">
                                            {% for value, display in vendor_status_choices %}
                                                <option value="{{ value }}" {% if value == 'active' %}selected{% endif %}>{{ display }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label for="rating" class="form-label">Initial Rating</label>
                                        <select class="form-select" id="rating" name="rating">
                                            <option value="0">Not Rated</option>
                                            <option value="1">1 Star</option>
                                            <option value="2">2 Stars</option>
                                            <option value="3">3 Stars</option>
                                            <option value="4">4 Stars</option>
                                            <option value="5">5 Stars</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="secondary_services" class="form-label">Secondary Services</label>
                                    <textarea class="form-control" id="secondary_services" name="secondary_services" rows="2" 
                                              placeholder="Additional services offered (optional)"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Machine Capabilities -->
                        <div class="card form-card mb-4">
                            <div class="card-body">
                                <div class="section-header">
                                    <h5 class="mb-0">
                                        <i class="fas fa-cogs me-2"></i>Machine Capabilities
                                    </h5>
                                </div>
                                
                                <!-- Tube Laser -->
                                <div class="machine-checkbox" id="tube-laser-section">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="has_tube_laser" name="has_tube_laser" onchange="toggleMachineDetails('tube-laser')">
                                        <label class="form-check-label fw-bold" for="has_tube_laser">
                                            <i class="fas fa-laser me-2"></i>Tube Laser Cutting
                                        </label>
                                    </div>
                                    <div class="mt-2 d-none" id="tube-laser-details">
                                        <label for="tube_laser_details" class="form-label small">Machine Details</label>
                                        <textarea class="form-control form-control-sm" id="tube_laser_details" name="tube_laser_details" rows="2" 
                                                  placeholder="e.g., ByStar 3015 Tube Laser, Max diameter: 200mm"></textarea>
                                    </div>
                                </div>

                                <!-- Sheet Laser -->
                                <div class="machine-checkbox" id="sheet-laser-section">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="has_sheet_laser" name="has_sheet_laser" onchange="toggleMachineDetails('sheet-laser')">
                                        <label class="form-check-label fw-bold" for="has_sheet_laser">
                                            <i class="fas fa-cut me-2"></i>Sheet Laser Cutting
                                        </label>
                                    </div>
                                    <div class="mt-2 d-none" id="sheet-laser-details">
                                        <label for="sheet_laser_details" class="form-label small">Machine Details</label>
                                        <textarea class="form-control form-control-sm" id="sheet_laser_details" name="sheet_laser_details" rows="2" 
                                                  placeholder="e.g., Trumpf TruLaser 3030, Max sheet size: 3000x1500mm"></textarea>
                                    </div>
                                </div>

                                <!-- CNC Machining -->
                                <div class="machine-checkbox" id="cnc-machining-section">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="has_cnc_machining" name="has_cnc_machining" onchange="toggleMachineDetails('cnc-machining')">
                                        <label class="form-check-label fw-bold" for="has_cnc_machining">
                                            <i class="fas fa-microchip me-2"></i>CNC Machining
                                        </label>
                                    </div>
                                    <div class="mt-2 d-none" id="cnc-machining-details">
                                        <label for="cnc_machining_details" class="form-label small">Machine Details</label>
                                        <textarea class="form-control form-control-sm" id="cnc_machining_details" name="cnc_machining_details" rows="2" 
                                                  placeholder="e.g., Haas VF-2 CNC Mill, Work envelope: 762x406x508mm"></textarea>
                                    </div>
                                </div>

                                <!-- VMC Machining -->
                                <div class="machine-checkbox" id="vmc-machining-section">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="has_vmc_machining" name="has_vmc_machining" onchange="toggleMachineDetails('vmc-machining')">
                                        <label class="form-check-label fw-bold" for="has_vmc_machining">
                                            <i class="fas fa-industry me-2"></i>VMC Machining
                                        </label>
                                    </div>
                                    <div class="mt-2 d-none" id="vmc-machining-details">
                                        <label for="vmc_machining_details" class="form-label small">Machine Details</label>
                                        <textarea class="form-control form-control-sm" id="vmc_machining_details" name="vmc_machining_details" rows="2" 
                                                  placeholder="e.g., DMG Mori NVX 5080, 5-axis machining center"></textarea>
                                    </div>
                                </div>

                                <!-- 3D Printing -->
                                <div class="machine-checkbox" id="printing-3d-section">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="has_3d_printing" name="has_3d_printing" onchange="toggleMachineDetails('printing-3d')">
                                        <label class="form-check-label fw-bold" for="has_3d_printing">
                                            <i class="fas fa-cube me-2"></i>3D Printing
                                        </label>
                                    </div>
                                    <div class="mt-2 d-none" id="printing-3d-details">
                                        <label for="printing_3d_details" class="form-label small">Machine Details</label>
                                        <textarea class="form-control form-control-sm" id="printing_3d_details" name="printing_3d_details" rows="2" 
                                                  placeholder="e.g., Stratasys F900, FDM Technology, Build volume: 914x610x914mm"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Technical Specifications -->
                        <div class="card form-card mb-4">
                            <div class="card-body">
                                <div class="section-header">
                                    <h5 class="mb-0">
                                        <i class="fas fa-tools me-2"></i>Technical Specifications
                                    </h5>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="max_material_thickness" class="form-label">Max Material Thickness</label>
                                        <input type="text" class="form-control" id="max_material_thickness" name="max_material_thickness" 
                                               placeholder="e.g., 12mm steel">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="production_capacity" class="form-label">Production Capacity</label>
                                        <input type="text" class="form-control" id="production_capacity" name="production_capacity" 
                                               placeholder="e.g., 50 parts/day">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="material_types" class="form-label">Material Types</label>
                                    <input type="text" class="form-control" id="material_types" name="material_types" 
                                           placeholder="e.g., Steel, Aluminum, Stainless Steel">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="quality_certifications" class="form-label">Quality Certifications</label>
                                    <input type="text" class="form-control" id="quality_certifications" name="quality_certifications" 
                                           placeholder="e.g., ISO 9001:2015, AS9100D">
                                </div>
                            </div>
                        </div>

                        <!-- Legal Information -->
                        <div class="card form-card mb-4">
                            <div class="card-body">
                                <div class="section-header">
                                    <h5 class="mb-0">
                                        <i class="fas fa-file-contract me-2"></i>Legal Information
                                    </h5>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="gst_number" class="form-label">GST Number</label>
                                        <input type="text" class="form-control" id="gst_number" name="gst_number" 
                                               placeholder="e.g., 29ABCDE1234F1Z5">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="pan_number" class="form-label">PAN Number</label>
                                        <input type="text" class="form-control" id="pan_number" name="pan_number" 
                                               placeholder="e.g., ABCDE1234F">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Submit Buttons -->
                        <div class="row">
                            <div class="col-12">
                                <div class="d-flex justify-content-between">
                                    <a href="{% url 'crm_vendors' %}" class="btn btn-secondary">
                                        <i class="fas fa-times me-1"></i>Cancel
                                    </a>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-1"></i>Create Vendor
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Toggle machine details visibility
        function toggleMachineDetails(machineType) {
            const checkbox = document.getElementById('has_' + machineType.replace('-', '_'));
            const details = document.getElementById(machineType + '-details');
            const section = document.getElementById(machineType + '-section');
            
            if (checkbox.checked) {
                details.classList.remove('d-none');
                section.classList.add('checked');
            } else {
                details.classList.add('d-none');
                section.classList.remove('checked');
            }
        }

        // Bootstrap form validation
        (function() {
            'use strict';
            window.addEventListener('load', function() {
                var forms = document.getElementsByClassName('needs-validation');
                var validation = Array.prototype.filter.call(forms, function(form) {
                    form.addEventListener('submit', function(event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();
    </script>
</body>
</html>
